#!/bin/bash

hname="tescht"


if [ "$1" = "create" ] ; then
  hcloud server create --name ${hname}  --type cx11 --image ubuntu-22.04 --ssh-key dc-pub-key --location fsn1
  sleep 20
  IP=$(hcloud server ip ${hname})
  ssh-keygen -f "/root/.ssh/known_hosts" -R ${IP} 
  scp -o StrictHostKeychecking=no /opt/dc/helper/docker@ubuntu-22.04.sh ${IP}:/tmp/dc-install
  ssh -o StrictHostKeychecking=no ${IP} /tmp/dc-install
  ssh -o StrictHostKeychecking=no ${IP} init 6
  # todo set root password
fi

if [ "$1" = "info" ] ; then
  hcloud server describe ${hname}
fi

if [ "$1" = "list" ] ; then
  hcloud server list
  #hcloud image list
  #hcloud location list
  #hcloud server-type list
fi



if [ "$1" = "delete" ] ; then
  hcloud server delete ${hname}
fi



