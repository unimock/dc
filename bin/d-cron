#!/bin/bash
. /opt/dc/funcs/script_funcs
CMD="$1" ; shift
if [ "$CMD" = "start" ] ; then
  mkdir -p /root/logs
  rm -fv /root/logs/*
  exit 0
fi
if [ "$CMD" = "end" ] ; then
  exit 0
fi
if [ "$CMD" = "job" ] ; then
  if [ "$1" = "-n" ] ; then
    shift
    NAME=${1} ; shift
  else
    NAME=`basename $1`
  fi
  cmd=$1 ; shift
  sf_start
  $cmd $*    >/root/logs/${NAME}.log 2>&1
  ret=$?
  if [ "$ret" != "0" ] ; then
    sf_set_error >>/root/logs/${NAME}.log 2>&1
  fi
  sf_end         >>/root/logs/${NAME}.log 2>&1
fi


