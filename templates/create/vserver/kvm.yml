type: kvm
kvm:
  #cloud_image: https://cloud-images.ubuntu.com/noble/current/noble-server-cloudimg-amd64.img
  cloud_image: https://cloud-images.ubuntu.com/releases/22.04/release/ubuntu-22.04-server-cloudimg-amd64.img
  image_name: ubuntu-22.04-server
  virt-customize:
    - --install qemu-guest-agent
  vol-pool:
    name: dc
    target: /var/lib/dc-kvm
  size: 5G
  virt-install:
    - --memory 2048
    - --vcpus 2
    - --os-variant ubuntu22.04
    #- --network bridge=guest-net,model=virtio
cloud-config:
  #system_info:
  #  default_user:
  #    name: karl
  #    home: /home/karl
  #password: xyz
  #chpasswd: { expire: False }
  hostname: <vserver_name>
  # configure sshd to allow users logging in using password 
  # rather than just keys
  users:
    - name: root
      ssh_pwauth: true
      lock-passwd: false
      passwd: xyz
      chpasswd: { expire: False }
      ssh_authorized_keys:
        - <ssh_pub_key>
  timezone: Europe/Berlin
  #packages:
  #  - quemu-gust-agent
  #  - tree
  #power_state:
  #  delay: "+30"
  #  mode: reboot
  #  message: Bye Bye
  #  timeout: 30
  #  condition: True
  #runcmd:
  #  - [ reboot ]

dc-install:
  dc:
    #- dist-upgrade
    #- docker
  apt:
    #- tree
